---
layout: page
title: 4D intravital imaging at single cell resolution
description: Methods to analyze 4D single cell dynamics in a living mouse.
img: assets/img/skin/skin_slice_through.gif
importance: 2
category: science
related_publications: true
toc:
  sidebar: top
---


In order to study the _dynamics_ of cell growth and cell cycle progression in an adult animal,
I developed an experimental system to directly observe and track hundreds of single cells in a living mouse,
over long periods of time, in 4D. {% cite xie_g1s_2024 %}

Most of the functionality described in this page is available at this [repository](https://github.com/xies/mouse_skin_size_control).


## Intravital imaging of mouse skin

<div class="container">
  <div class="row justify-content-md-center">
    <div class="col-lg-6">
      {% include figure.liquid loading="eager" path="assets/img/skin/imaging.png" title="imaging a mouse's skin" class="img-fluid rounded" %}
    </div>
  </div>
</div>
<div>
Schematic of imaging the interfollicular epidermis of an anesthetized mouse's hind paw.
</div>

The methods to image mouse cells were pioneered by [Valentina Greco](https://www.grecolab.org/lab-members)'s group,
who established protocols to perform the longitudinal re-imaging of the same tissue regions,
and has made available many reporter mouse lines generated by her group.

This powerful technique uses two-photon microscopy, which can penetrate deeper
into tissues compared to single-photon excitation. I can directly image fluorescent mouse lines that express
reporters for cellular structures (e.g. nucleus, cell boundary) and cell states (e.g.
  cell cycle phase, cell type), and produces three-dimensional images of
  a small voxel of the living epidermis.

I then use various landmarking techniques to navigate back to the same exact tissue region in the same mouse
over many imaging sessions, allowing the mouse to return to its normal housing
and activity in between short imaging sessions.

This technique can collect time-lapsed '3D snapshots' of the same piece of skin tissue
over many days, if not months.
<br>
<br>
<br>

## Image processing: 3D alignment

Although we have these 3D snapshots of the same region, they are not pixel-perfect. There are always
slight variations in position and angle from timepoint to timepoint. Therefore, I built tools
to register timepoints in 3D, and generate a final 'aligned movie' with fixed coordinates. I
am currently working on publishing a [napari](https://napari.org/stable/) plugin of this functionality.
<br>
<br>
<br>

## Single cell analysis: 3D segmentation

Segmentation in 3D remains challenging to do accurately and at scale. I generated
training data and trained deep learning models (based on [stardist3D](https://github.com/stardist/stardist),
[plantseg](https://github.com/kreshuklab/plant-seg), and [cellpose](https://github.com/MouseLand/cellpose) working in 3D stitching mode)
to perform 3D boundary segmentation with high fidelity. These models can be deployed
for analyzing new images I generate, allowing me to process datasets much faster.

<div class="row justify-content-md-center">
  <div class="col-lg-6">
    {% include figure.liquid loading="eager" path="assets/img/skin/skin_slice_through.gif" title="imaging a mouse's skin" class="img-fluid rounded z-depth-5" %}
  </div>
</div>
<br>
<br>
<br>

## Single cell analysis: 3D tracking
Cell tracking poses an even larger challenge compared to segmentation, especially in
3D. Currently, I am performing semi-automated cell tracking in 3D using the
[Mastodon](https://github.com/mastodon-sc) lineage visualization and tracking, and I have
developed software to interface with Mastodon outputs and integrate them into the
rest of the analysis pipeline.

This produces high-fidelity tracking of skin stem cells in my movies.

<div class="container">
  <div class="row justify-content-md-center">
    <div class="col-lg-6">
      {% include figure.liquid loading="eager" path="assets/img/skin/dense_cyto_t0_to_basal_tracks.gif" title="imaging a mouse's skin" class="img-fluid rounded z-depth-5" %}
    </div>
  </div>
</div>
<br>
<br>
<br>

## 3D microenvironment analysis
In order to analyze how the microenvironment around each cell changes over time,
I developed a computational framework to:
- <u>encode cell-cell contact maps in 3D</u>: by automatically inferring what cells
are touching from 3D segmentations and defining a graph-based encoding of each cell's "neighborhood"
- <u>extract tissue-level geometry and its changes</u>: by fitting 3D meshes of the epidermis-dermis interface
   and performing geometric operations on these meshes
- <u>extract features of the extracellular collagen matrix that is in contact with each cell</u>:
by analyzing the anisotropies of the second harmonic generation signal generated by collagen in the dermis
<br>
<br>
Combining this framework with high-fidelity 3D single cell segmentation and tracking yields
a rich dataset that has unprecedented insight into the cellular dynamics that underly
how an _in vivo_ tissue evolves over time.

<div class="container">
  <div class="row justify-content-md-center">
    <div class="col-lg-8">
      {% include figure.liquid loading="eager" path="assets/img/skin/microenvironment.png" title="imaging a mouse's skin" class="img-fluid" %}
    </div>
  </div>
</div>
<br>
<br>
<br>
<br>
